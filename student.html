<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Attendance</title>
    <link rel="stylesheet" href="style.css">
    <!-- QR Scanner Library -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <style>
        /* Manual entry improved visuals */
        #manual-entry { display:none; margin-top:16px; background: linear-gradient(90deg, #fffaf0, #fff6fb); border-radius:12px; padding:14px; box-shadow: 0 8px 24px rgba(12,20,30,0.06); max-width:780px; margin-left:auto; margin-right:auto; }
        #manual-entry label { font-size:0.95rem; color:#374151; display:block; margin-bottom:8px; }
        #manual-entry .manual-row { display:flex; gap:12px; align-items:center; }
        #manual-entry input { flex:1; padding:12px 14px; border-radius:10px; border:1px solid #ffd6a5; background:#fffef8; color:#2b2b2b; font-size:1rem; outline:none; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6); }
        #manual-entry input::placeholder { color:#caa6a6; }
        #manual-entry button { padding:11px 16px; border-radius:10px; background: linear-gradient(90deg,#ff7b7b,#ff6b95); color:#fff; border:none; font-weight:600; cursor:pointer; box-shadow: 0 6px 12px rgba(255,107,107,0.12); transition: transform .12s ease, box-shadow .12s ease; }
        #manual-entry button:hover { transform: translateY(-2px); box-shadow: 0 12px 20px rgba(255,107,107,0.18); }
        @media (max-width:600px){ #manual-entry .manual-row { flex-direction:column; } #manual-entry button{ width:100%; } }

        /* Attendance report section styles */
        #attendance-report-section { display:none; margin-top:24px; background:#f9f9f9; border-radius:12px; padding:16px; box-shadow: 0 8px 24px rgba(12,20,30,0.06); max-width:800px; margin-left:auto; margin-right:auto; }
        #attendance-report-section h3 { font-size:1.5rem; color:#333; margin-bottom:12px; }
        #attendance-report-container { margin-top:12px; max-height:350px; overflow-y:auto; text-align:left; }
        .attendance-row { display:flex; justify-content:space-between; padding:8px 12px; border-bottom:1px solid #eee; }
        .attendance-row:last-child { border-bottom:none; }
        .attendance-date { font-weight:500; color:#555; }
        .attendance-status { font-weight:600; }

        /* Student dashboard buttons */
        #student-dashboard { display:none; margin-top:24px; text-align:center; }
        #student-dashboard button { padding:12px 18px; border-radius:10px; background: linear-gradient(90deg,#6ee7b7,#3b82f6); color:#fff; border:none; font-weight:600; cursor:pointer; margin:0 8px; box-shadow: 0 6px 12px rgba(110,231,183,0.12); transition: transform .12s ease, box-shadow .12s ease; }
        #student-dashboard button:hover { transform: translateY(-2px); box-shadow: 0 12px 20px rgba(110,231,183,0.18); }

        /* View attendance section styles */
        #view-attendance-section { display:none; margin-top:24px; background:#f9f9f9; border-radius:12px; padding:16px; box-shadow: 0 8px 24px rgba(12,20,30,0.06); max-width:800px; margin-left:auto; margin-right:auto; }
        #view-attendance-section h3 { font-size:1.5rem; color:#333; margin-bottom:12px; }
        #view-attendance-section .form-group { margin-bottom:16px; }
        #view-attendance-section select { padding:12px 14px; border-radius:10px; border:1px solid #cbd5e1; background:#fff; color:#374151; font-size:1rem; outline:none; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6); }
        #view-attendance-section button { padding:12px 18px; border-radius:10px; background: linear-gradient(90deg,#60a5fa,#3b82f6); color:#fff; border:none; font-weight:600; cursor:pointer; margin-top:8px; box-shadow: 0 6px 12px rgba(96,165,250,0.12); transition: transform .12s ease, box-shadow .12s ease; }
        #view-attendance-section button:hover { transform: translateY(-2px); box-shadow: 0 12px 20px rgba(96,165,250,0.18); }
    </style>
</head>
<body>
    <div class="container fade-in">
        <h2>Student Portal</h2>
        
        <div id="login-section">
            <form id="student-login-form">
                <div class="form-group">
                    <label for="student-id">Student SRN</label>
                    <input type="text" id="student-id" placeholder="e.g. 02FE24BCS410" required>
                </div>
                <div class="form-group">
                    <label for="student-password">Password</label>
                    <input type="password" id="student-password" placeholder="Password" required>
                </div>
                <button type="submit" class="btn">Login & Scan</button>
            </form>
        </div>

        <div id="scan-section" style="display:none;">
            <h3>Scan QR Code</h3>

            <div id="reader" style="width: 100%; min-height: 250px; margin-bottom: 15px; background: #eee;"></div>

            <p id="scan-status">Requesting Camera Access...</p>

            <div id="scan-result" class="message"></div>
        </div>

        <!-- MANUAL ENTRY MUST BE SEPARATE (outside scan-section) -->
        <div class="form-group" id="manual-entry">
            <label for="scan-input">Camera not working? Enter Session Code:</label>
            <div class="manual-row">
                <input type="text" id="scan-input" placeholder="Enter Session ID" />
                <button id="manual-submit">Submit Session ID</button>
            </div>
        </div>

        <!-- STUDENT DASHBOARD OPTIONS -->
        <div id="student-dashboard" style="display:none;">
            <button id="scan-code" class="btn">Scan Code</button>
            <button id="view-attendance" class="btn">View Your Attendance</button>
        </div>

        <!-- ATTENDANCE REPORT VIEW -->
        <div id="attendance-report-section" style="display:none;">
            <h3>ðŸ“Š Attendance Report</h3>
            <button id="fetch-attendance-report" class="btn">Get Attendance Report</button>
            <div id="attendance-report-container" style="margin-top:20px; max-height:350px; overflow-y:auto; text-align:left;">
                <!-- Attendance report data will be dynamically inserted here -->
            </div>
        </div>

        <!-- VIEW ATTENDANCE SECTION -->
        <div id="view-attendance-section" style="display:none;">
            <h3>ðŸ“Š View Attendance</h3>
            <div class="form-group">
                <label for="subject-select">Select Subject:</label>
                <select id="subject-select">
                    <option value="Software Engineering">Software Engineering</option>
                    <option value="Cloud Computing">Cloud Computing</option>
                </select>
            </div>
            <button id="get-attendance" class="btn">Get Attendance</button>
            <div id="attendance-data" style="margin-top:20px; max-height:350px; overflow-y:auto; text-align:left;">
                <!-- Attendance data will be dynamically inserted here -->
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>